using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace StrikersTools
{
    class Password
    {
        public static readonly Dictionary<int, byte[]> hashedPasswords = new Dictionary<int, byte[]>()
        {
            [0] = new byte[] { 0x8D, 0xB7, 0xAF, 0xD1, 0xC9, 0xF8, 0xEB, 0xD5, 0x05, 0x52, 0x27, 0x76, 0x41, 0x34, 0x63, 0x52, 0x00, 0x00, },
            [1] = new byte[] { 0x8D, 0xAB, 0xAF, 0xCD, 0xC9, 0xE9, 0xEB, 0xA4, 0x05, 0x28, 0x27, 0x16, 0x41, 0x65, 0x63, 0x5B, 0x00, 0x00, },
            [2] = new byte[] { 0x8D, 0xA1, 0xAF, 0xDD, 0xC9, 0xAB, 0xEB, 0xB6, 0x05, 0x71, 0x27, 0x1C, 0x41, 0x6F, 0x63, 0x5D, 0x00, 0x00, },
            [3] = new byte[] { 0x8C, 0x6E, 0xAE, 0xB3, 0xCA, 0x01, 0xEA, 0x20, 0x04, 0xE6, 0x26, 0xF7, 0x40, 0x9C, 0x60, 0xB9, 0x00, 0x00, },
            [4] = new byte[] { 0x8D, 0xBC, 0xAF, 0xF9, 0xC9, 0xBC, 0xEA, 0x32, 0x04, 0xEB, 0x26, 0xF7, 0x40, 0x8C, 0x62, 0x90, 0x00, 0x00, },
            [5] = new byte[] { 0x8D, 0xC7, 0xAF, 0x91, 0xC9, 0xB1, 0xEB, 0xD2, 0x05, 0x49, 0x27, 0x02, 0x41, 0x3B, 0x63, 0x45, 0x00, 0x00, },
            [6] = new byte[] { 0x8D, 0xB8, 0xAF, 0x9E, 0xC9, 0xF0, 0xEB, 0xBD, 0x05, 0x26, 0x27, 0x1F, 0x41, 0x14, 0x63, 0x32, 0x00, 0x00, },
            [7] = new byte[] { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, }
        };

        public static byte[] GetHashedPass(string input)
        {
            byte[] hashed = new byte[16];
            var stringBytes = Encoding.GetEncoding("sjis").GetBytes(input);
            Array.Copy(stringBytes, hashed, Math.Min(16, stringBytes.Length));

            var key = 0;
            for (var i = 0; i < 2; i++)
            {
                var shift = i * 8;
                hashed[0 + shift] ^= (byte)(key ^ 0xF);
                hashed[1 + shift] ^= (byte)((key + 0x11) ^ 0xF);
                hashed[2 + shift] ^= (byte)((key + 0x22) ^ 0xF);
                hashed[3 + shift] ^= (byte)((key + 0x33) ^ 0xF);
                hashed[4 + shift] ^= (byte)((key + 0x44) ^ 0xF);
                hashed[5 + shift] ^= (byte)((key + 0x55) ^ 0xF);
                hashed[6 + shift] ^= (byte)((key + 0x66) ^ 0xF);
                hashed[7 + shift] ^= (byte)((key + 0x77) ^ 0xF);
                key += 0x88;
            }

            return hashed;
        }


    }
}
